#include <RcppArmadillo.h>
#include <Rcpp.h>
#include <RInside.h>
#include <population.h>
#include <bp_mcmc/utils.h>

using namespace Rcpp;

int main(int argc, char **argv) {

  std::cout << "Hello world\n";

  // Create R instance (for RNGs) and set seed for reproducing test results
  // Currently unused
  RInside R;
  //PulseUtils pu;
  //pu.set_seed(999999);


  ///////////// BEGIN LOADING DATA STRUCTURES ////////////////

  // Rcpp::NumericVector thistime(144);
  
  // for (int i = 0; i < thistime.size(); i++) thistime(i) = (i + 1) * 10;

  // Create Data

  Rcpp::NumericVector pop_time = 
    {	     
	10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 
	110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 
	210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 
	310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 
	410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 
	510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 
	610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 
	710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 
	810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 
	910, 920, 930, 940, 950, 960, 970, 980, 990, 1000, 
	1010, 1020, 1030, 1040, 1050, 1060, 1070, 1080, 1090, 1100, 
	1110, 1120, 1130, 1140, 1150, 1160, 1170, 1180, 1190, 1200, 
	1210, 1220, 1230, 1240, 1250, 1260, 1270, 1280, 1290, 1300, 
	1310, 1320, 1330, 1340, 1350, 1360, 1370, 1380, 1390, 1400, 
	1410, 1420, 1430, 1440 
    };

  Rcpp::NumericVector pop_conc_vec = 
    {  
	4.80490276783118,5.55438590470489,5.82389660594809,1.65941726681491,7.68124705671574,4.70770439108617,5.24399814405679,2.33231606659325,5.27234095302059,3.06673439681989,
	5.18426022867423,4.70971539421762,4.51945398432444,1.44224377099611,7.96913022105512,6.03404910626944,5.16834557800299,2.29795324678268,5.74133791572125,7.80417115535233,
	4.16263741397125,3.95642886702816,4.03382793967936,2.85791164196307,7.23656645456995,8.2560851195286,4.86519350005284,2.47719557486192,4.57853702934388,9.78483775379735,
	4.74875043483603,4.72958214537841,3.85584777964193,5.7679432934033,6.21185757286704,6.19357928965548,3.90968453770305,2.06625475305885,4.82669504046086,8.86878974035808,
	3.75415053028297,6.86611110427984,3.47955611788336,6.1353855800739,6.0575084171796,7.41625759408411,5.69107991525824,2.00711668913211,4.21265104589699,8.29195533990328,
	3.94578366127969,5.92640787291524,3.3280860125175,5.93317980719605,5.67669855230686,6.04026105602813,7.01959290670987,2.12888519269165,4.01041043335033,7.19287373374035,
	3.48765083020515,5.77301527735829,2.95355841855966,5.37868851270038,4.8736938918755,5.78593510894012,6.92263715645642,2.15991013996149,3.76563398780007,5.66255947527526,
	3.36581448361617,5.36381782396746,3.11718215553178,4.77045390971886,5.03308001309841,5.36304743680763,7.14931731497061,2.22090239403628,3.43465779406376,5.24895265652914,
	3.53882051247484,4.66524494226973,2.76217159739568,4.05864773636224,5.40961923156883,5.14127758482166,6.67617480532428,1.96464513452488,3.91651119528576,5.06287073305178,
	3.29595624609306,4.95878190121751,4.14814892153626,3.96362013302486,5.26452876339062,7.98934391037445,6.21516425115664,2.07772392366566,5.29944539687675,5.23692194315978,
	2.93592086681205,6.49154695945825,4.40599716616614,3.23135428364978,4.61686194616125,7.31661813559071,5.59960046313125,1.92823549151036,6.10113109888055,4.44087768300685,
	3.1633094213063,6.35041181595164,3.92720336464883,3.62335236970887,4.90474963107212,7.5727298809817,5.21758466121273,2.06523603901355,6.04522232050486,4.12475966969959,
	2.90597565162964,6.6084474336122,3.47558926908271,4.62427160057307,4.68747686597605,5.98394596153132,4.7522082502507,2.27233387530624,6.3253270430533,3.91022533616494,
	2.92151672206753,5.27838988023633,3.55373156155452,5.68927671968317,4.29383976707952,6.25860864592096,4.86381956531942,1.98206570908932,5.52561951801355,3.93412155407285,
	2.68503206974419,4.89028229804547,3.22610317506434,4.23457178317477,4.28867084772098,5.67959925506314,4.19022162937644,1.84479092233291,4.81704916401883,4.46695332611567,
	2.67524018031034,4.41613679740769,3.69962965552397,4.08662548797496,3.93159342629936,7.48965259902722,3.6192326961015,1.80348107710202,4.50105174014193,8.43708037109902,
	2.56425328516662,3.63462277781109,4.01657927642659,3.13978075041025,8.3812689951134,8.98815650033091,5.42943700359421,1.63141742111529,5.07669600029629,10.275674452074,
	2.49399262318874,3.71114168587838,3.67687259813988,3.28219738431232,9.51978188332889,8.40245823437708,7.76797187656662,1.75454520250343,5.76617220830199,9.52873833243772,
	2.44892419235088,3.34206387403846,3.07740946084084,2.79568652194437,8.12618740591847,7.64538248214216,7.67539945416398,1.85071516382674,7.19204767311503,7.25773565274139,
	2.69479476072901,2.95739573801624,2.57233679060904,2.57465365646477,8.13645922269876,7.62638887873849,6.81788160309854,2.65088407092025,6.74628857521153,7.23297976625725,
	2.76248121849418,2.55642879862659,2.93427257297769,2.47170139798372,6.39368608374371,6.84158913362117,6.30786431545411,4.09805124803858,6.17262604895947,6.37724532182461,
	2.52721839713841,2.78915246986893,2.67914487213775,2.32582898228155,7.42670861389842,5.79259527907929,5.49922258089939,4.49108549172251,5.34304109818833,6.67135451315871,
	2.52615190809569,2.73381081454936,2.16183959854065,2.10293145905974,6.30511162531908,6.14876603631158,5.14480635935812,3.87502401719102,5.8029369379189,6.57563552824686,
	2.47344814081801,2.53641365902801,2.28753543898289,2.10645135135643,5.76990575322467,5.97189763647649,5.38343988296588,3.46678605441443,4.6008809407142,6.07016386918503,
	2.60002424346546,2.40184286211412,2.30004641925388,2.01142214432463,5.10183020317597,5.29389086836804,4.43040898296617,3.51936421676959,4.64072900969587,5.74969374071315,
	2.58588981976575,2.46194907612911,2.4956763618129,2.11361887521259,4.73242044292829,4.84076658622993,4.36893052025715,2.98612618621689,4.23033820676289,5.34500101109301,
	2.50789473770802,2.00600437476401,2.18279744732073,1.90491194450583,4.4615921044418,4.15212795085557,4.20649617085062,3.90714707187765,6.00191733921124,4.76476377010966,
	2.452194847658,1.86562824724352,2.28856629397847,2.01598440431033,4.89118100407309,3.868810252745,4.53717354719991,3.97470342112398,7.44102601484673,7.26453868527277,
	3.40626152517761,2.06760328740121,3.28239612556173,1.81414733954697,6.50615663727544,4.09737259214513,7.2204945629881,3.23007065409815,6.29315439757106,8.4976300779974,
	5.30885087719194,2.05610341157275,5.79921124511728,1.55123419541866,6.06233652271614,3.86721138861597,7.18803044712256,3.0889709131489,6.50995215995824,7.3744675891833,
	5.69802242168834,2.15172520439966,5.11489162670687,1.83327560488081,6.2025561256536,4.17139427752783,6.0804354870996,2.91495434415903,6.07943268546858,6.49399944140442,
	4.82456119520081,1.82963724777577,4.71858016052918,1.53567443225851,5.76471171910284,3.75953301665469,5.63948457555365,2.44796879590373,5.16922655672309,5.80310989307419,
	4.62897365750702,2.19270685146916,4.20085321042726,1.70722090772781,5.6142281571087,3.17889352345784,6.57047653638476,2.65835652848399,4.63086656928704,4.9930905308345,
	4.28219720339624,2.21904715540535,3.98752658191055,1.8071661452803,4.82235208581487,3.46184909087832,7.33722848796779,2.47737383752648,4.57825583617622,4.83060649850838,
	3.97623112359069,3.48384149630318,3.57781524317873,1.60064987465711,4.09748583116991,3.73320379912336,8.43138135162123,2.57919547617979,4.38037573581437,4.51947331305458,
	3.58128372725462,6.16066680380589,3.14972694734715,1.79227953864183,3.85679908087237,3.04637199175065,7.31070919931909,2.42508294379543,3.6853496410195,3.75690692863772,
	3.86941500628959,6.72814308396191,3.08377440304487,1.64256864413054,4.00290154043659,3.08040101980245,7.53282529663012,2.14291187787433,3.31898091233838,4.19712190499099,
	3.980645818532,6.10646169047816,2.67913138744365,1.48236371367964,3.42419153476475,2.86984402384103,6.73914384101278,3.06830914031583,3.75529154198297,4.04875878213519,
	3.3076760395203,5.72552471835248,2.76301822946652,1.54978377992345,3.84489030088544,3.01542122553989,6.29817252121181,3.62015323033818,3.30814035885092,3.75504581352602,
	3.48856217134681,4.5278082718073,3.64463710472866,2.90888630668723,6.17970163330303,3.2112377427587,5.22082290539546,3.76396423348635,2.78153095589695,6.13289794916537,
	3.9826622705945,4.54365947941086,4.94266816793402,8.6265855063909,6.84832912848239,3.02769607560733,6.46276419705845,4.14458970676907,3.15683774925172,6.60776372860581,
	4.88270951565092,3.64295536974302,4.4213919471611,7.88705130834937,6.1706202622207,3.35131529412757,8.07511385702894,3.2925509458997,2.90992654326389,5.52125079758807,
	4.91327947395158,3.82505022342883,4.58536602924215,7.67308639896419,5.23695447901403,2.77522461668733,7.48936919791974,2.96187309503273,2.85223437834869,4.68068173738864,
	5.41377911369629,3.73607035494265,3.36728794944452,6.3036341368709,6.22909060357334,3.07240323722756,6.79380807671561,3.09847481268689,3.02072511925294,4.63857921144143,
	4.34463716759819,3.31386976557736,3.20648438392019,5.62780791573207,5.39156169408787,4.1367565551725,6.0469137045117,2.95778472991081,4.37629204842732,4.2567130802278,
	4.8083653744498,2.89960084106516,3.4557425194245,5.20218207103233,5.23502517620399,7.30056460188533,5.77794158459259,2.7738635868544,5.95476257813781,4.11267843601536,
	3.57135656615769,2.55992587520348,2.67093923990437,4.14956293017389,4.46776650248023,9.4422159399812,4.72894024651507,2.84239656141918,5.42259229200158,4.0043140255013,
	3.84668454423916,2.86567704061729,2.51061593289715,4.0921067490053,4.25928685402602,8.74556422011491,5.3574228634267,6.28149164811701,5.20825480631444,4.11091841991726,
	5.06985362900138,2.4274797039475,2.80486074954505,3.87007925967872,4.16739626153182,7.88011921858693,4.72659951685772,7.839022480106,4.39116971846119,4.29757826998219,
	7.52459449093445,2.1927210941394,2.44727787846897,2.95062245583204,4.30292862895719,7.25367008533359,4.71101411958254,6.82952420504048,4.43101349860251,4.41586224181564,
	6.91325883073893,2.17434949823883,2.78880205621475,2.83619093255842,3.63747497823086,6.0015697620858,4.4695758824764,6.98239360802176,4.35052385728012,3.87654549873496,
	5.62215592811323,2.43638177065459,2.35757082433943,2.78171121782967,3.66513421007804,6.11795090675494,4.26888548707325,7.01507374069695,3.74352968402021,3.88021448554537,
	5.63021020979621,2.13597717737339,2.0839710260402,2.44121027944667,3.42464436312478,5.89812560119055,3.61673367692169,6.11363767096663,3.72213109213373,3.84025470937792,
	4.85513213739411,2.0400834106422,1.84842554642584,2.20213822605733,3.1788232321568,4.49390398687807,4.30601997643954,5.78254574850345,3.69106529388427,3.59610894344106,
	4.68330916147533,2.90183600762345,2.15382657347147,2.38332575604517,3.67182508443565,4.39292458541166,5.21758605044533,5.80032618378792,3.09080278949808,4.17691266997692,
	4.39636103775636,4.83015194143171,3.21454430900583,2.36828117014537,3.34770216723423,4.57000625654361,5.88295698829348,4.94834150453527,3.10701705893408,4.30921577051449,
	4.47012672191666,5.25322120611227,5.56736427525071,1.9751466067271,3.15203018189906,4.39389301532138,5.64659357032151,4.87205696194825,3.31686696967427,4.29124885553202,
	4.07427542453638,4.95889825484905,5.41945288598929,2.14227031988095,4.51284430826964,4.78225106648797,5.4717041399104,4.38623273636138,3.10760750472709,4.32716450275667,
	4.12708911843516,4.09697174674679,5.32810869788814,2.05430197878279,5.47714445491308,7.42242018720114,5.43707750326319,3.64084086541911,2.92150004090942,4.29175994273903,
	6.21117043318266,4.14488052784797,4.67709315302738,1.82393181642533,5.60866120350031,7.69568838121581,5.83280352223979,3.2811325906708,2.76212425720179,4.2428791614546,
	5.97136845165868,5.56933381418232,3.68207897011618,1.6981973917866,5.10352499467966,7.50752496094147,6.75180532947611,3.43956962831095,2.45307610428744,3.52194506465799,
	6.28956491922418,7.57718616588535,3.56363048544674,1.67932119692018,4.91478826100746,6.08108851430378,5.39305065437917,2.7297342803932,2.88956700807247,5.64092619370051,
	6.49131250718954,6.9726508846763,3.03496267355944,1.77207903473058,4.36452751751155,5.54839969169193,5.82080802465769,2.90955398862322,2.91245124856668,7.03432682686683,
	5.25062988837981,5.9774465701198,3.21945133629947,1.74330965667069,4.21415998850384,5.37869261323123,4.96440317693952,2.58246464938284,2.84964530470243,6.86158932827143,
	4.55935769853853,5.56923474811909,3.25351239619083,1.71066889910336,4.06231490982729,5.56073793442319,4.97374580804277,2.68240444235927,2.55456112220165,5.46728928568746,
	5.18216961908952,5.44609629652732,3.2754853714306,1.82388104761968,3.94512030338921,5.15977113736694,4.28167305211983,2.62371709931583,2.82662184695445,5.83886944881866,
	4.90308468381633,5.89916495326917,3.18636919264853,1.621944040801,4.89299471289102,5.38413299266012,5.87130957584191,2.59819736796237,2.90586302544698,4.86078249785052,
	4.01891285286513,5.7953208720115,3.36503027825976,1.78401794513447,7.15625495759175,7.05009872426509,9.09790418281439,2.87412610722979,2.71424327038124,4.3070299132607,
	3.54018694082779,5.47971881618952,2.72242065506266,1.32775030451819,7.24626034377537,7.4659931658727,8.03704456842432,4.78654030294797,3.04625494215676,4.38873413865676,
	4.00300507000749,4.88632812029552,2.93679916567257,1.5442866607023,6.03014743558718,6.34339989643867,8.66872574179339,5.48035935566092,3.86115192876113,4.41610964997487,
	3.14312027638362,5.00849564817215,2.48295475484835,1.71005012378934,5.91243197754931,6.22449410163966,6.86377089086879,4.96157071673675,3.63588916094328,3.83656191959535,
	3.5428868597519,6.34325949470134,2.39754239822083,1.54107170536315,5.37808532215905,6.03877617542093,6.86243092172166,4.44268479570096,3.59023402234083,3.26275230309113,
	3.22461811555509,5.78383201279752,2.68271548056839,1.72218864006486,4.7734676901371,6.30324357941718,9.40895342540384,4.28847457380709,3.34003262710309,3.63471104640352,
	2.70018520259928,5.45309971308288,2.91960221993245,1.27267169452678,4.67949184695823,9.08434614041727,9.85742821156091,4.09550724448125,3.22169128976026,4.34015684823783,
	4.70935789808139,5.30994002421987,4.46539448680576,1.61130404195781,8.3828059882389,8.9577112088041,7.66797084887635,3.65913194517187,3.41613874175892,6.69738295982306,
	8.64766254797096,4.63314027418248,4.51471955519522,3.79507992666187,8.92847238721593,7.85771435037275,8.25306669705971,3.28939913204253,2.82744495405785,6.98811244230799,
	10.1177681276222,3.81070976979298,4.26249589791809,5.40144562660231,7.73802011177682,6.9125183666192,7.06449712816907,3.24202274759842,3.02840186859614,6.07337522219411,
	8.87495234360497,3.75781471976909,3.40579485943742,5.10055784157732,8.10142366556006,6.4072031160732,6.16689245942652,3.0043432999087,2.91570170092497,6.44241506099729,
	8.04650617069681,3.8844249602613,3.18633873472813,4.12473968071592,7.77795973801946,6.0329489759106,5.88342889122713,3.09559134890091,2.67705083975533,5.60906140955611,
	7.77345730194877,4.82659827081226,3.48060549030124,4.3317629171194,8.45443579606375,5.70667706558745,6.00251695206635,3.89622472527919,2.4533062345641,4.77689637348147,
	6.83132869902898,7.54230413313786,2.74137769541466,3.90205846190193,7.07123382054492,7.50961251285851,4.94196551357689,5.23673854766879,2.33009346500698,4.91052294465647,
	6.11273944123071,9.03657069212609,2.54716148622978,3.26474783930984,6.5272470735641,9.92177712731142,4.05398459104361,4.44102575019101,2.57491729707084,4.57806169488857,
	5.7352263288293,7.93956496891058,2.2844648046209,3.42154913163984,6.03896975748735,9.3722145012686,5.00680346287395,4.02005276093964,2.89815085493112,4.5019987030008,
	5.21639473990167,6.18257426446577,2.6565253594679,2.65684836525937,5.80185199665508,8.54250569209623,4.31546208652615,3.79480711687849,3.11970197465419,3.82346983198254,
	4.42108843351402,5.02477527448268,2.14686668513223,2.99783715680024,5.6325647022239,7.3574312783421,7.55356840865976,3.5047018714944,3.53431923530446,4.14712261999592,
	4.35215549385339,5.13291118782543,2.19459642603487,6.52038906528177,5.05366171637668,7.43412435299031,9.4640780622159,3.60745940871934,2.99326261736849,3.70354651498047,
	3.96378475715302,4.10818977302138,2.41554902247508,6.79018900840287,4.64514645891623,8.63102373566612,7.9318448065699,3.38245721704539,2.99345636788151,3.18309107322946,
	4.32807264847289,4.06016923260909,2.07560198183974,6.65941192625108,4.19253467253807,6.81791456036929,8.13596259248908,2.89564904681455,2.75145014056057,3.02210399227975,
	4.02238328390712,3.97761195846688,2.12507602783333,5.16729365030432,4.26810607752847,7.26704385127285,6.79922856316138,2.88487221150949,2.86073741015283,2.98878079112946,
	5.34409599870102,6.64636351961205,3.01564972304727,4.436509307783,3.92943128856456,6.31132098662999,6.71651860754665,2.59807149690545,2.94424084140995,2.79271100932347,
	7.48762904276177,6.41556141990253,5.67954912854024,4.25343252080455,4.00827455789594,5.1747330239209,6.64168068989592,2.75030316949317,2.75168951237735,3.01695976481347,
	6.5083780971729,6.67772254668891,6.77495782353145,4.01748060987789,4.61006978389387,5.11120043503722,5.88763883571594,2.199772831096,2.85418509719682,2.58338983046796,
	6.29161653209924,5.64771350282574,6.20069731556924,3.53656666960417,5.39105479452246,5.64947094179463,5.71662156732775,2.27500340770836,3.29586559301633,2.52546542282965,
	5.39411707891633,5.16722543421669,4.75797557743174,3.15199693064436,5.45394697125072,4.73089738507807,5.18571631700653,2.49498515030378,3.77793282334274,2.48014925884122,
	5.78457265590088,5.52898559437979,5.33417431287164,3.18032612630665,6.22505158242838,4.12245009062065,4.46066396738981,3.27204540499395,3.38631891856888,2.5917826758131,
	5.61909639389583,5.94953796804462,4.24321293642644,3.1635684976765,4.43617553785676,4.37530673041519,5.26352051125242,5.05691051358415,3.32809025226371,2.69627444539248,
	6.25635311312761,5.02014844274505,3.82487724026244,2.37205271703904,5.41188912783983,3.66420208729422,5.48233783256322,4.132471276027,3.20459892204804,4.50180573798031,
	8.10708971209833,4.51596894391522,3.34295537792112,2.54783189943097,4.80806748134438,3.57360546412504,5.9783112400084,4.84353388972665,3.34533222296501,5.95585392724131,
	6.56676815759448,4.63687290344051,3.30968301329121,2.392539546542,4.69916304607942,3.84355866248021,6.38503549400584,3.78102128838665,3.25016638261382,5.49437905543969,
	7.05960810255261,3.96609406134457,2.91604739897289,5.83553594127705,3.64366406197506,3.78441479436664,5.75097568334729,4.27010736899025,2.9233329255969,5.07653556454271,
	5.99120604892533,3.32154966180012,3.00358730672914,8.93436783354008,3.68875036026983,5.19599487409731,5.09457176314206,4.84295998932994,3.40974247431354,5.35930417951795,
	7.95852908889097,3.40961510826576,2.61163786388362,8.61282546051646,3.66797118458692,6.19730614203536,6.8237820416095,4.17790517331629,2.85622005124464,5.1440305922623,
	9.4704865784483,3.16248097583141,2.19735194927941,7.17507791377243,4.85112784988961,6.10045812622925,7.0252140849256,3.76679321478522,3.63527928422791,7.1259249357781,
	6.73959086161939,3.03557395171788,2.54173858200891,5.84661702619699,6.84429295384469,6.11116909897831,6.51254166421159,3.73161272453097,5.72904555909673,7.91321671625245,
	6.89291625256646,2.62369468179419,2.45862372953241,4.84496182905077,6.49613059988991,5.50483057828424,6.0710651354553,3.87972445846222,6.65261780480751,8.49039983476437,
	6.40270953000422,2.66223210793157,2.33536420829069,5.08766773510667,5.7972466064175,4.76771159491321,5.15266122854383,4.57004225302167,5.9387523663247,6.79542784119169,
	5.2182521767259,2.84038699582883,2.14495962591119,5.43273360319628,5.26620137678887,3.85400577996642,5.61632235198426,7.8629910719578,5.48938388256026,5.87733855380636,
	5.25618214231168,2.09597363168075,2.15951742804444,5.2536823241879,6.73576283081038,4.88031091994128,4.84830873459455,6.31179612916647,4.55856042561648,6.11872733494622,
	5.17999115804222,2.25406100961427,2.20596733585112,4.22572703284556,6.65502162348778,4.5862175758368,4.56667029858623,6.41808801057272,4.64525156867112,6.47182300341795,
	4.38983832374725,1.99829678489512,1.86578046164727,4.91273224307445,7.1166808562722,4.08975346438958,6.90130937422799,4.95997662589944,4.66754465790023,9.16839163966659,
	4.61208017792059,1.89455393632256,1.88779964278121,4.37604052359149,6.47528388847162,4.02991616854946,6.7926310056775,4.56860482335127,3.733335039301,9.80089926036018,
	3.95309247139031,2.77238884582061,2.35428309189362,4.21302368718706,6.19841507045488,3.60784180550878,7.46511042928794,5.42476367873695,3.67296267437601,8.02344367331739,
	3.73813773328596,5.18318206830149,3.79392171705256,3.25948453474911,6.28502568095494,3.71707311428942,5.46667803226058,6.10144606947433,3.69139491428089,7.37591453119135,
	4.26325829870651,5.36243358662859,4.08281327754717,2.62816349245005,5.65967639601221,3.70522179910077,5.65579503161179,6.1776685113658,3.07779938731463,6.80138574974928,
	3.46277871724898,5.71111677674868,4.14700073328737,3.14900137584012,5.42672082069469,3.54095384010137,4.8461851876267,5.18206371635735,3.33303264677265,6.1293656034696,
	3.21712326156223,4.79369459278158,3.79508728631591,2.95192531998929,6.89677281934125,3.28712889061755,5.46034541027646,4.37980556814288,3.04717104872472,5.69248218154143,
	4.06471347961177,4.73741445300525,2.98468157662342,2.66119929575811,8.2732585537518,2.86696977094339,8.58697230058803,3.76595954945897,3.09922484602053,5.37153720246916,
	5.78947580369306,3.97951524178108,3.20107752373104,2.45150675093996,7.05201847438317,3.07700903075241,10.5341698093663,4.1471150373841,3.08020475328319,4.69494186471456,
	5.52933692405949,3.60799807883377,2.64994175444953,2.40252027964065,5.90939862452359,3.55366086218943,8.16356166650338,3.47982377581843,3.63693914724051,4.79229992089407,
	4.8359295529844,3.42416403406123,2.85281132809083,2.0305281412991,6.02680231526604,3.17544558347187,7.65092555350295,3.23362806855569,4.85743878241223,5.05716691232594,
	4.43316530490597,2.89721959212345,2.28294287106434,2.38207059426867,5.08663826422919,3.28073128952066,6.18557097961178,2.92309076019076,5.20493389699138,5.75217938914913,
	4.03360159986605,3.0416653947031,3.12411152367945,4.13181733111651,4.88968477524328,4.6198665273178,6.13155285557624,2.86853082291366,4.98205769382826,5.45467687275408,
	4.17485276153937,2.82187113246684,3.23688088284033,3.71034639956308,4.93730534263684,5.71968721314304,5.9470620507606,2.69869861567715,4.61308909015224,4.49829504037731,
	3.91081060159301,2.57477245689095,3.22379040079063,2.87803909602672,4.63601732883854,4.71195681228182,6.00518348589176,2.95698590565858,4.51494907406476,4.29694942642271,
	3.51548936697478,2.20833757798113,2.94039390298811,2.75120099973732,4.20103168983508,4.66876620351397,8.79637514079779,3.85348338610085,4.27445744855001,4.25906052606859,
	3.93709604444867,2.47064158432675,3.01466230173142,2.86933398734861,3.5687422656861,5.09032143002948,10.8270942439195,4.43085423815493,4.07237100176924,4.01429150625795,
	3.54732465045912,2.42745449202059,2.2460119449067,2.77195006703309,3.23945921246923,4.47021851762378,7.35635385513079,3.78643189832769,5.16988885329777,4.026114109138,
	3.18749206585717,2.26705417424536,2.40016643235575,2.23911101024717,3.86310585943157,3.80358928081642,8.3643590684951,3.41317530458414,5.50026381616438,3.47122264756614,
	3.04788445203572,2.12983870239451,2.40288235257864,2.58099555988619,3.53441391506509,4.20204809915727,6.68169785803676,3.50664007717423,4.72459310928605,2.96255410820053,
	2.9743022022697,2.31310081183574,2.10447589083092,3.46419675305855,4.64125873939736,4.25648187360475,7.35296408280528,3.21994170886295,3.8398425011826,3.21086178060309,
	2.69538745924286,1.78583745242766,2.36884412886295,6.07082026996948,6.00190607637222,3.89365068798894,7.25003477285886,2.65246537652621,4.47436540124571,3.09455441655381,
	2.91346635657328,2.10288857346819,2.12291619414449,5.01900298891539,5.89071035743695,4.75699008324914,5.47266599105063,2.68711379186643,5.53669759144008,2.76999575951481,
	4.7989411738232,1.80171302546309,2.05633160537482,4.51461963040744,4.74501653913943,5.17973371505607,5.85754392745666,2.77107244649901,8.6411357031487,3.02699036351811,
	6.77744058889634,2.26056643516125,2.12720234496232,4.13035815129817,5.41679846333653,4.96055019560482,5.04897197149402,2.25273093816838,7.95974156936128,2.63406683394453,
	6.75520341519414,3.72839296029998,1.78499354437456,4.04794890578869,4.63746680566094,4.85122276377504,4.62913543927661,2.49675666005527,7.44889876081448,2.5915884485111,
	7.29175605419279,5.59585295585951,2.21386986384036,3.2006522467815,5.70805782510451,3.77869899564091,6.17733509912336,2.6239338322554,6.80957544036386,2.89708750323923,
	5.53483902611443,5.97534176617401,2.0198122227418,2.96512116848115,8.46136841389303,4.42648099714933,6.16266555037719,4.34870129461362,5.65598005320815,2.90265046954807,
	4.67377174445583,4.93732290148175,2.58560230299264,3.05441949056586,7.8573187816382,3.96204041802811,7.53844208425741,4.82316782349752,5.15088246158008,2.71651169615074,
	4.46967427738354,4.66307904747851,3.95755905891351,3.58774248729116,7.26808453751575,3.92527859875464,6.41958099442008,4.82611419479121,5.0927223721876,2.46337864414813,
	4.59049028695589,3.83114955675628,4.87592584187047,4.43191997612181,6.4599263251026,3.73773452348943,6.02660481271043,4.88207009059529,5.02908195029044,2.29441758200225,
	4.54889208349458,3.76681172865362,4.44313098222424,3.88435508290336,6.00309623215155,3.24855406020117,5.57316605137416,3.6581393044431,4.53808124658784,3.2373237337047,
	4.39727180721073,3.07435763746264,4.24892580027688,4.24509701485515,5.50812874693789,3.20962772652094,5.3666561432583,3.78894074249917,4.35873012101839,4.47635950289876,
	4.46444334314394,3.60807824007266,5.45878903474014,3.28779202962237,5.34906634543737,3.3127833080026,4.40857798223297,3.07678178413838,3.75736908824137,5.20375579116063,
	4.3190173244412,2.98622656492932,6.13238450418514,3.63462848693272,4.67071037495628,3.08616444073868,4.56702090560515,3.25267381687012,3.37917825344974,6.30405248202139
    };

  pop_conc_vec.attr("dim") = Dimension(10, 144);

  // Convert concentration vector to matrix   
  NumericMatrix pop_conc_matrix = as<NumericMatrix>(pop_conc_vec);
  pop_conc_matrix = transpose(pop_conc_matrix);

  // Create Priors, Proposal Variances, Starting Values

  Rcpp::CharacterVector pop_location_prior = "strauss"; // or "order-statistic"
  Rcpp::List pop_priors = List::create(Named("mass_mean")               = 1,
                                       Named("mass_var")                = 100,
                                       Named("mass_p2p_sd_var")         = 2,
                                       Named("mass_s2s_sd_var")         = 2,
                                       Named("width_mean")              = 1.5,
                                       Named("width_var")               = 100,
                                       Named("width_p2p_sd_var")        = 2,
                                       Named("width_s2s_sd_var")        = 2,
                                       Named("baseline_mean")           = 3,
                                       Named("baseline_var")            = 100,
                                       Named("baseline_s2s_sd_var")     = 10,
                                       Named("halflife_mean")           = 45,
                                       Named("halflife_var")            = 100,
                                       Named("halflife_s2s_sd_var")     = 10);
  pop_priors.attr("class") = "bp_priors";

  // Create estimates object (w/ starting vals)
  Rcpp::List pop_startingvals = List::create(Named("mass_mean")           = 3.5,
                                         Named("mass_p2p_sd_var")         = 3.0,
                                         Named("mass_s2s_sd_var")         = 1.0,
                                         Named("width_mean")              = 40,
                                         Named("width_p2p_sd_var")        = 5,
                                         Named("width_s2s_sd_var")        = 1.0,
                                         Named("baseline_mean")           = 2.6,
                                         Named("baseline_s2s_sd_var")     = .75,
                                         Named("halflife_mean")           = 45,
                                         Named("halflife_s2s_sd_var")     = 5,
                                         Named("error_var")               = .005,
                                         Named("error_alpha")             = .001,
                                         Named("error_beta")              = .001,
                                         Named("mean_pulse_count")        = 12,
                                         Named("strauss_repulsion")       = .5,
                                         Named("strauss_repulsion_range") = .05);
  pop_startingvals.attr("class") = "bp_startingvals";

  Rcpp::List pop_proposalvars = List::create(Named("sub_mass_mean") = 1,
                                         Named("pop_mass_mean")     = 0.5,
                                         Named("ind_mass")          = 2,
                                         Named("sub_width_mean")    = 1,
                                         Named("pop_width_mean")    = 0.5,
                                         Named("ind_width")         = 5,
                                         Named("pop_baseline_mean") = 1,
                                         Named("sub_baseline")      = 0.015,
                                         Named("pop_halflife_mean") = 1,
                                         Named("sub_halflife")      = 50,
                                         Named("pulse_location")    = 1);
  pop_proposalvars.attr("class") = "bp_proposalvariance";

  //////////////// END LOADING DATA STRUCTURES ///////////////
  
  // test
  // Create sampler object
  Rcpp::List pop_rtn_list;
  pop_rtn_list = population_(pop_conc_matrix,
                         pop_time,
                         pop_location_prior,
                         pop_priors,
                         pop_proposalvars,
                         pop_startingvals,
                         100000,
                         50,
                         10000,
                         true,
                         500,
                         25000,
                         0.25,
                         0.35);
  

  return 0;


}



#include <RcppArmadillo.h>
#include <Rcpp.h>
#include <RInside.h>
#include <population.h>
#include <bp_mcmc/utils.h>

using namespace Rcpp;

int main(int argc, char **argv) {

  std::cout << "Hello world\n";

  // Create R instance (for RNGs) and set seed for reproducing test results
  // Currently unused
  RInside R;
  //PulseUtils pu;
  //pu.set_seed(999999);


  ///////////// BEGIN LOADING DATA STRUCTURES ////////////////

  // Rcpp::NumericVector thistime(144);
  
  // for (int i = 0; i < thistime.size(); i++) thistime(i) = (i + 1) * 10;

  // Create Data

  Rcpp::NumericVector pop_time = 
    {	     
	10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 
	110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 
	210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 
	310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 
	410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 
	510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 
	610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 
	710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 
	810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 
	910, 920, 930, 940, 950, 960, 970, 980, 990, 1000, 
	1010, 1020, 1030, 1040, 1050, 1060, 1070, 1080, 1090, 1100, 
	1110, 1120, 1130, 1140, 1150, 1160, 1170, 1180, 1190, 1200, 
	1210, 1220, 1230, 1240, 1250, 1260, 1270, 1280, 1290, 1300, 
	1310, 1320, 1330, 1340, 1350, 1360, 1370, 1380, 1390, 1400, 
	1410, 1420, 1430, 1440 
    };

  Rcpp::NumericVector pop_conc_vec = 
    {  
	8.3659294172565, 5.99843830169133, 5.02996585990326, 2.39426811171822, 2.03781551194736,
       	3.14836595759910, 3.18812281447109, 2.64701675375985, 3.07135345082608, 7.76348998505956,
	6.85261027142648, 4.83698047581896, 4.56945725341303, 2.47660694128577, 2.22002030953814,
       	2.87134868860285, 3.21791970631999, 2.44418401458851, 3.19331776793741, 6.93507750077898,
	6.02641828030805, 4.97563897353079, 4.09692233207299, 2.17110495605322, 1.9191607227229,
       	3.32433193614728, 3.1331783214524, 2.86613682651968, 3.10769275780406, 5.87569058319872,
	5.45927922600583, 4.74704125667513, 4.39462059139126, 2.74543874968815, 2.45564175982283,
	2.89605273511054, 3.13037319768574, 2.72097180157995, 2.72583854364142, 6.70531038056604,
	5.7824626779864, 4.74730771827568, 4.07834790411869, 2.55463985757101, 2.36554256123958,
	3.00602753566758, 3.09570601264837, 2.50620277864699, 2.7957286257776, 12.3146455095918,
	5.62896999944582, 4.55012676213898, 3.75357858880273, 2.59383788896023, 2.53616066979624,
	3.08089318404099, 3.0128593071493, 2.45716967199719, 2.90918552012267, 14.3862172187607,
	5.43696173445066, 3.54247166455255, 3.68018391220205, 2.60198280200439, 2.63659626016132,
	2.79007995022233, 2.96682829061575, 2.16560335677220, 2.84036426878489, 12.8316788449254,
	4.83027390190789, 3.34399090411529, 4.92936106940697, 2.86466490286653, 2.32329628818543,
	2.43997380256115, 2.57679578588282, 2.43097079166765, 2.66531562679644, 12.1321242679345,
	4.25529741832971, 5.98129414315103, 9.29869637081826, 2.67114911971168, 2.1477522918966,
	3.2912834755813, 3.58699775385978, 2.58183063024907, 3.31812345753362, 10.6570541055824,
	3.90756915385688, 10.9156661289698, 7.94755897838677, 3.03468802587662, 2.27551602678790,
	3.28977929273616, 3.68158945970105, 2.52630471345811, 2.63013825079700, 10.5463355096681,
	3.53931140235745, 9.97720773684314, 7.35003113276926, 2.93076841225697, 2.22280239347318,
	3.26920935225732, 3.95651616534637, 2.64013971346261, 2.54972657853543, 15.6218508345344,
	3.51449447854697, 8.99357068749078, 7.54519502930762, 2.39263091816266, 2.01657162377513,
	3.0219187073755, 4.17618851226195, 2.59660619919292, 2.97412117887943, 16.0034211803499,
	3.84251878531626, 6.96688014839729, 6.05625389734162, 2.51371066599715, 2.24942892234312,
	2.91181181586643, 3.65305641349037, 2.64324064533808, 2.56889450307035, 15.5916552378044,
	9.07371230077877, 7.51329612467428, 5.87558445399879, 2.98768664098609, 4.60484554019188,
	2.90279250474746, 3.79312695803539, 2.28546483223627, 2.44695711306298, 14.3717014799944,
	14.0818074273337, 5.9303980514784, 5.11027354383113, 2.8461718092085, 8.68213202358808,
	2.87570916134579, 3.19531601180781, 2.46059064045891, 2.47250792575394, 12.6136023576879,
	11.9405397766550, 6.5716622444927, 4.49202991541468, 2.79864324724583, 8.19798618870576,
	3.14182582323117, 3.40370384127938, 2.42779470693323, 2.46266849266743, 11.9497413304225,
	11.9412552300663, 4.65350668484312, 4.94246005301872, 2.56697827112903, 6.3846037132224,
	2.68332787323769, 3.51500644698163, 2.2094721294186, 2.55872051022398, 9.69601299539082,
	9.6073571269314, 6.35676616641898, 6.51556805006306, 3.25983193410848, 5.99898937998843,
	2.79573330257577, 5.73416607885056, 2.32503302067677, 2.55188988364122, 8.90660493052197,
	8.90678947172773, 6.67173361144063, 8.15056669720733, 2.46053924614229, 5.37939904165956,
	3.13549376610856, 6.53634331327216, 2.30428619781146, 2.48264584904763, 8.1249104442711,
	7.19884695308244, 6.11509884671479, 7.18010145780539, 2.8271115696385, 5.06290284593477,
	2.43396174734559, 6.72631710443325, 3.19323262052413, 2.68834369991486, 6.89663759972037,
	7.74511923381837, 5.11649988630761, 6.40410737514208, 2.69924017060457, 4.42789858126906,
	2.75513365268208, 7.3534985165388, 2.86839666145536, 2.65936025226651, 6.52455942157658,
	5.97845179451192, 5.43262577895302, 4.89046119750943, 2.91918391386968, 4.46069343960735,
	2.25797015350069, 5.39671328899818, 2.89899744983546, 2.24090879620919, 6.1088417927659,
	5.61601122794602, 4.15199614468367, 5.84791654370836, 3.19809226617069, 3.82923921982927,
	2.68534871081584, 5.003326859292, 2.65535793034401, 2.21175862150458, 4.64728031585591,
	5.23562891876382, 4.77957686037596, 5.61195054920171, 3.23164890613797, 3.73119829296185,
	2.78731268730248, 4.58789805683777, 2.52249341694272, 2.30359275222896, 4.65913104180963,
	4.91172501022744, 4.66713182768668, 4.58958548757180, 2.97686754069769, 3.40497249465823,
	3.55601791570524, 4.60797743991028, 2.31463067249747, 2.3161842656295, 4.14662689464500,
	4.53741088450895, 3.63660063513253, 4.98266926695605, 3.1171183855463, 3.47587292801210,
	4.75497402298125, 4.43300395383869, 2.40235830230301, 2.40682048164527, 4.33238516475701,
	4.29781117485406, 3.87318753828356, 10.6321802233574, 3.07695088012851, 3.36694357861745,
	5.06115668004913, 4.27450306249209, 2.44669596713999, 2.46768786103455, 5.01170364238408,
	3.39107889875245, 3.57612625854770, 11.5772632540298, 3.1226178541086, 3.2185568178557,
	4.52998233544786, 5.41295448434808, 2.56269289918439, 2.63784109206446, 5.22766998333256,
	6.23584785172145, 3.44963574255142, 10.5342077458031, 2.91260278694155, 3.14153771490112,
	4.0182768301621, 7.91302142455943, 2.09444082913575, 2.46376361195594, 5.47099758342571,
	10.1122910549677, 3.28248587062175, 8.65860603025865, 2.86894951584651, 2.70359714901824,
	3.72331952432015, 8.0537476390044, 2.23571920805730, 2.06647374927011, 4.94042097155361,
	10.2237808010929, 3.19867317510855, 7.71454478625513, 2.77863898559168, 2.84353079731613,
	3.37000330457425, 8.75117533949553, 1.76981225057149, 2.32698138959014, 4.97327024412418,
	7.60526813368034, 3.2286734290776, 6.51342578903867, 3.13831824810782, 2.84980261051441,
	3.42619918592872, 7.89275042305162, 1.92131354137301, 2.42608701181907, 6.38878317637535,
	8.30162284312703, 4.19121749892032, 6.33643678059945, 3.26798977211568, 2.54962578583855,
	3.22511094604241, 6.69638656185526, 1.97023178063018, 2.30918063582318, 8.27027714013844,
	7.55577524213505, 5.92668698799509, 6.60791966093156, 3.30005685535151, 2.5173819960291,
	3.54287108601906, 6.02888034534615, 2.28185701125039, 2.62495900063926, 7.9067439822339,
	6.08041435906563, 5.59314326038371, 6.40196651668897, 3.33449868941429, 2.53809879167315,
	3.19336260620328, 5.87239955015573, 3.96929106383727, 2.82470033678462, 8.20083567744657,
	6.07465511209157, 5.12158768371066, 5.14495084639085, 2.64536726494284, 2.46475847907369,
	4.19074644498507, 5.47623826444188, 3.43547714271893, 2.74942102611632, 6.67727040571485,
	5.10940967387822, 4.72022270425748, 7.9474007896659, 3.00564797355318, 2.31784002280662,
	8.63092182333, 6.17702594276023, 3.48361324856095, 2.65046269888360, 5.81222099816881,
	5.03593922960612, 5.16772180659281, 7.65395785558136, 2.96193191017549, 2.36332819330641,
	7.58742538322496, 6.0276418231995, 3.12676509668784, 2.69544989056709, 5.35227946072168,
	5.09850041495356, 4.3580489862295, 6.0208582859187, 2.63016924872780, 2.39600735019954,
	6.49096493226392, 5.56585504039264, 3.34519773805626, 2.83511962848988, 5.33751623934985,
	7.57110507243904, 4.087926898917, 5.95137713231437, 2.58162393279115, 3.12988723027036,
	5.99828982590173, 5.55152302952194, 2.97576047292531, 2.59503152604885, 7.24144780737051,
	8.0713501460683, 3.71052981735600, 5.65326140332328, 2.54406123789188, 3.04731559753163,
	5.3309767914679, 5.13966414668292, 2.56306255625779, 2.37889512632777, 10.0978969119163,
	8.14660438609202, 6.31332873848252, 5.41042536083449, 2.9345626024612, 3.35234294001917,
	5.47297463325458, 4.78208382050757, 2.72219867595212, 2.96097701533177, 8.55364473286195,
	7.15447319722844, 8.03930211604486, 5.43665278986313, 2.98182187206510, 2.99049408681701,
	5.36873139064656, 4.12909319552581, 2.50566848119973, 2.79713713281929, 8.57487503437477,
	6.42147622180935, 7.84136561632234, 4.52373723228679, 2.68861315745811, 3.19328762136483,
	4.31930228016657, 5.08427752662392, 2.27331539376723, 2.73249819736017, 8.47188362940996,
	5.91138177447696, 5.71235586136855, 4.01644201034807, 2.76007124429173, 2.93425297783369,
	4.31632590087502, 4.75306317562449, 2.68282803213242, 2.53388644545317, 6.87316294699557,
	5.40384296498706, 6.53292807526646, 4.2216744621462, 2.68332443312924, 2.97120139869812,
	3.65713615460063, 5.29988264370122, 3.17262227930652, 2.58289528285927, 5.90662395229407,
	5.41048544954694, 6.05457912158695, 3.92838429785296, 2.69529221704827, 5.85692202445901,
	4.25283146649889, 5.34841098929433, 4.06599021141218, 2.52080157553032, 5.79483847676244,
	4.43702402554917, 4.82368408406882, 3.632837647232, 2.7394515157726, 5.66985486891089,
	3.41870964517287, 5.43459379058268, 4.6314171719389, 2.7236981830419, 6.13494331620429,
	4.76263732133910, 4.62375603580765, 3.5587067223115, 2.8476252542935, 5.55380904478744,
	2.57588534680214, 5.10833744356458, 3.43382015746048, 2.38261394564838, 4.88399668570203,
	3.90782523595753, 4.2754835939144, 3.73985813037842, 2.55035991117101, 5.69519601771736,
	3.50264101076875, 4.57064194878578, 2.77073599224608, 2.69894238405, 4.99641136025681,
	3.72371742595611, 3.71177430517409, 3.58433547774123, 3.11288529316537, 4.253178603945,
	3.0014337180156, 4.15491647505569, 3.18303726874609, 2.40895066119763, 4.20998968493128,
	3.69744188063608, 4.15877712533674, 5.64648967785628, 2.70058684510568, 4.47995203345411,
	3.09280447087563, 4.11211426607537, 3.18471754120928, 2.61160656570688, 3.47754513032049,
	3.26202745546571, 3.39082183960254, 9.73705838340865, 2.71323399886243, 4.39833101206827,
	3.1049956964206, 4.18901567576399, 2.53670361462374, 2.10229810680911, 4.00377293746802,
	3.28655096399329, 3.55084281559756, 9.08279596623361, 2.62619618487791, 4.25040278784819,
	2.7658412624076, 3.74487648769726, 2.77058568793833, 2.53602653881333, 5.7011149850046,
	3.37855541926713, 3.84659680367447, 9.72192900292132, 2.48886470713021, 3.62217787516566,
	2.6081373195074, 3.86891893038038, 2.5284606342618, 2.29424045243973, 5.81275418888516,
	3.3937701703242, 3.09633421258784, 7.4826599515901, 2.54610477927112, 3.67363345445876,
	2.75538893331089, 3.30525318074429, 2.5063520920542, 2.4878340254264, 4.81651349866877,
	2.99774722850683, 3.36095893491687, 7.4831351523082, 2.35154666283059, 3.33473848748703,
	2.59460168019064, 3.78935442390386, 2.30913975267448, 2.56279687452153, 4.38276320980932,
	3.01030444017925, 3.04044111911549, 6.7879983962222, 3.10709720027536, 3.09482754233377,
	2.75317282909109, 3.5217743526954, 2.22302287344258, 2.22554381027307, 4.12943383475317,
	2.7157417682439, 3.36341805424339, 6.29691575984183, 2.70471316522806, 2.93100772114848,
	3.17291605283369, 3.52991476367225, 2.25098783993311, 2.76237205439307, 3.76790369834333,
	2.35997581280495, 2.71644766109021, 5.64718899049301, 2.62625946175529, 2.79227773602104,
	2.79798615636283, 3.95837851757705, 2.05385563443445, 2.49423299837558, 3.94767031639934,
	2.53009802220043, 2.75419686874922, 5.23884233820516, 2.68748564059404, 2.72161154506929,
	2.66288969612135, 3.73465955456242, 2.21557851330386, 2.40040331103759, 3.59402318017418,
	2.77923279941762, 3.02129654961805, 5.00730120098595, 2.48510599844922, 3.55470583008855,
	2.73841973801286, 4.22359148608844, 2.56704534307265, 2.32956215700530, 3.69307198978283,
	2.87171709922876, 4.92945321325698, 4.57363164037982, 2.50850534597811, 4.88513006539704,
	2.78020483251854, 4.47144770922337, 3.94342963270234, 2.34444794557090, 4.26186754115155,
	2.97632903323662, 13.7840026987415, 4.32106474742312, 2.56982570036292, 4.38557088719769,
	4.17722849757432, 4.78587224958915, 4.39895228761455, 2.56149903742976, 4.33479475896323,
	6.61962229593109, 9.95734538088725, 5.40224131786361, 2.57829628129478, 4.17672591108472,
	4.06852413560812, 4.76890219636506, 4.50856121760582, 2.50644956623358, 4.68546362645138,
	18.5686551918416, 9.23772710471946, 7.45703155833694, 3.02775115626685, 3.47422468307147,
	3.83755335269522, 4.50525435411528, 4.0580449860348, 2.37696372820564, 5.4499152777593,
	16.1701142159575, 9.9803316451042, 8.96863387131288, 2.77532124618104, 3.54317463635502,
	3.6313608089886, 4.00256008915093, 3.49196088772494, 2.64997933269068, 4.50676714678334,
	15.4681948875052, 8.22379292938358, 8.93954431626824, 2.57255114998459, 3.41442831996599,
	3.14418938799321, 3.70856036394007, 2.81618872874316, 2.27806661049326, 4.49840253275117,
	11.7566673228512, 7.92081070336918, 7.45308159633382, 2.68538847666705, 3.06641403096021,
	3.43924511845188, 3.89942229205369, 2.76717705575219, 2.53113651045820, 3.75057691298551,
	12.6364905937976, 7.65272000496951, 7.55072491236271, 2.72919572606771, 3.55976354206339,
	3.57908317123855, 3.85260352252341, 3.04316568690971, 2.58007119785782, 3.60421004892729,
	9.61618127215282, 6.34238335768032, 6.03939996095796, 3.04052619643439, 3.51722767160914,
	3.38107419968513, 3.51280010534851, 2.41048402830353, 3.03690708305819, 3.81616420286828,
	10.1618383826356, 11.7380387449619, 5.4994252551107, 2.81370169651635, 2.63397579296631,
	3.15995212380501, 3.26870194234161, 2.48543825230255, 4.53328731646461, 3.46803372717165,
	8.73293675169558, 13.3196358497234, 5.62644839744902, 2.55261413932334, 2.85958365357046,
	2.94256018628784, 3.50575791317199, 2.43559075882962, 5.34722968175027, 3.39844975822539,
	7.08534001442421, 12.4430671265703, 8.37910594592313, 2.50758488482793, 2.80289786615322,
	3.02725700440646, 3.19568940163597, 2.51941404493887, 5.27036482334433, 3.39675345839934,
	5.9267925137663, 9.6625432802943, 9.3036733883587, 2.60254714564336, 4.58196232433516,
	4.18986040594696, 5.59521387243463, 2.96600873016090, 4.64523398861541, 3.05763953146106,
	5.61378711937913, 8.61090494432688, 7.8079042137374, 2.52841702800318, 4.63756297308812, 
	4.25159525510142, 5.79092427970394, 2.95019329003955, 4.54794661114656, 3.00519143145594, 
	5.53268159488144, 8.28954969573159, 7.56001907874745, 2.71675671152988, 4.69265093516527, 
	3.97181596166681, 4.85854234429226, 2.79200961981052, 4.12680650304267, 2.95118958393615,
	7.3976482382339, 6.92352227255327, 6.95863089751636, 2.90851840760541, 3.98413777380169,
	3.73403687449554, 5.32062556480073, 3.00719977944709, 3.31679503839811, 2.81630443298244,
	15.0324587879959, 6.29212953450302, 6.2966970869491, 2.80849704485476, 3.16316306747698,
	3.57496946588289, 4.84733404388117, 2.66885484658416, 3.58707246976706, 2.90312812928754,
	19.1971259957957, 17.0673125652906, 5.42239335675032, 2.38036348394607, 3.38790698175361,
	3.01615657667045, 5.53026278389985, 2.93065788723991, 3.35063950685947, 2.728076640293,
	15.7710028326981, 15.8624208129275, 4.89251251763054, 2.84420048497453, 3.23929031638219,
	2.84699213430627, 4.36231331960455, 2.59062293653525, 3.24497865154177, 2.46773825490876,
	14.3663114002575, 12.8416348886934, 4.42342113309709, 2.81611811901719, 2.81356827658379,
	3.15752624036771, 4.25371207531424, 2.14047084085058, 2.95426240198996, 2.87704486473343,
	13.3214136946194, 12.6236507408949, 5.46516777634998, 2.70977334727954, 3.79523599012264,
	2.82068626505587, 4.36462417560594, 2.29702396437406, 2.91791442011423, 2.55062337485356,
	11.3473459007577, 10.8861378892073, 6.94078698146905, 2.53374533038779, 5.16358926635293,
	3.00570556816566, 3.89821628231736, 2.14978963688849, 2.90975697461485, 2.45614328871216,
	11.3442433137918, 9.03792662911384, 8.33526206467196, 2.39056939299333, 4.99094889811468,
	3.87339668505406, 3.75016775654757, 2.50322226189296, 2.92187704937527, 3.75775913765386,
	8.93696435291414, 8.45645483955177, 7.16252325728883, 2.50750437706240, 4.92959698151453,
	5.97539578545631, 3.98946680086606, 2.26856346524113, 2.77617755196724, 6.59721405493765,
	7.63912271156818, 6.78076018395194, 6.81819733419075, 2.56925848076826, 4.79274474030215,
	5.25889770802449, 4.02581593141440, 2.13086564629524, 2.70878714590311, 8.09391555351159,
	6.44638836319281, 7.34212863573622, 6.10088761262663, 3.72939291472502, 4.02923374803192,
	5.16716760518079, 4.0048583612835, 2.16326679146572, 3.00467924112734, 7.09635825897488,
	7.24780892933466, 5.70786766311404, 4.57223202147190, 3.54008730786578, 3.46120301278198,
	4.1817423342134, 3.63728963862508, 2.07282500235911, 3.22528680561829, 7.17784308125209,
	6.0673115900948, 5.56458017056163, 16.1868956539566, 3.38561456815565, 3.75866085825024,
	4.41321186512501, 3.70775511122255, 1.97614055464617, 3.27512673944527, 6.49763658514187,
	5.89292398732421, 5.24173296703507, 21.521618960226, 3.46773776868069, 3.45729511007009,
	4.32474354151621, 3.34539435780536, 2.38393656828818, 3.43365911989194, 5.9963056308023,
	7.66221124224146, 4.50107254962226, 19.1739749841745, 3.29684482791150, 3.44652511010397,
	3.7164096119055, 3.51087758504126, 2.31446178890445, 3.00591812973992, 5.38487943031933,
	7.7117050797229, 5.31919062564723, 15.9512261966893, 2.55620647401986, 2.57750850138721,
	3.37556525048848, 2.79465906951973, 3.34266989337402, 2.92129952465146, 5.25768094598893,
	7.69681786420595, 4.16830307554307, 14.0992074820238, 2.51226360376446, 2.68262779781284,
	3.02065094691624, 3.35163335281849, 3.43239031339694, 3.41459962401561, 4.7086892827305,
	6.04938966231947, 3.96792030601673, 12.2328418521472, 2.87222350951552, 2.68057038159321,
	2.90140823915968, 3.3456418156282, 3.08133222905401, 2.48472316488849, 4.82902758112499,
	5.65873358556164, 3.89293899422515, 11.0747821846548, 2.88120914526038, 2.90054851989629,
	3.07664340620118, 3.21454789822522, 2.54073844117162, 3.02289251621201, 4.06616836020491,
	5.55377923720761, 3.59667513835117, 10.8559813264889, 2.90268290298759, 2.61987591934220,
	2.95555925204885, 3.46916778331475, 2.69897127239373, 2.57857255908412, 3.962423029356,
	5.15793538430618, 2.92004904963732, 9.0662350279544, 2.80753345721643, 2.48718661024192,
	2.87062379785002, 2.92080846294230, 2.64466689886752, 2.62356609942167, 6.93930271721205,
	4.46774833295662, 3.32225753066716, 7.44810308040857, 2.92995750692081, 2.44914917937255,
	2.79298308855838, 3.25905201391184, 2.83244074420028, 3.02998157461888, 6.00655235627125,
	4.02679934156182, 3.45730813081493, 8.13374765706762, 2.52694043405240, 2.24400999627700,
	3.24338174179722, 2.69417842375113, 2.23187163025114, 2.74420480858217, 5.93450546869701,
	4.50549888087645, 3.60644671230773, 6.67158488270762, 3.47646262692457, 3.22611076135758,
	2.74586432146737, 3.17453254024409, 2.39564124118179, 2.89923039441653, 5.45160386998422,
	4.30541757331506, 5.98750449187567, 5.92529282851673, 2.66650038225589, 3.14565644542056,
	2.48818728068332, 3.20747458020249, 2.44714502646705, 3.01792229014727, 5.25977450100904,
	3.97858283627820, 5.34132212545780, 5.80074131516079, 2.53787206366337, 3.23551413799757,
	3.24353905883605, 3.02757845094649, 3.98437083717562, 3.07447175669981, 4.34127162992951,
	3.36004698897453, 5.20469489818901, 5.62962099194357, 2.63084576160470, 2.71864568111498,
	2.91549267088696, 3.67398980592857, 4.02113159241043, 3.21546825532442, 3.82173327355871,
	3.23821737643868, 4.75734319600439, 5.16194413524168, 2.67365607605722, 2.72215712294212,
	2.53448392757291, 3.33249681310703, 3.66962802163071, 3.05940760219613, 3.57215749392483,
	3.20404275515316, 4.14736661957573, 4.92716942648384, 2.93418962835393, 3.12568136533254,
	2.74954800647079, 3.6981904161929, 3.25886267711186, 2.80804603778356, 4.0889800080292,
	2.86574792746219, 4.50168879286354, 4.96019603386828, 2.44860684084954, 2.869235030322,
	2.71887301339221, 6.93236595745179, 3.28979884085186, 3.48476351065316, 5.3965346506022,
	3.44159081608981, 8.37363178797629, 7.4659856921488, 3.99007156500904, 2.3924957392305,
	2.52313999836141, 6.98074323781067, 2.68809189386705, 3.07533708923988, 6.8739931616811,
	2.87455917502408, 8.93315947303955, 6.36813137111403, 3.40848635073928, 2.10809170733676,
	2.67916263208531, 6.59788072053642, 2.79119171664548, 3.43727977327293, 6.02550196782299,
	2.72772793398373, 7.65799878712604, 6.29769195290695, 3.32959322557791, 2.43741263963310,
	8.76490080324748, 6.06017180331701, 2.90101558456439, 2.75265999560295, 5.86521401134361,
	2.61161947365035, 8.00085187157773, 4.502622966414, 3.42731479497106, 2.27065701237094,
	7.94743587775306, 5.80391025950566, 2.63430955873569, 3.15414613996627, 6.03062018365876,
	2.72522911924381, 6.27687135147399, 4.82622468915925, 3.58821865708523, 2.31111710751576,
	8.10248930653853, 5.87066801253785, 2.55460467689136, 2.69456853773104, 5.39017798894764,
	2.40588709899205, 5.95512515453019, 4.63021585460597, 3.39331118738224, 2.39538912697233,
	6.17699132708497, 5.66682652248815, 2.85181135537918, 2.52417857415557, 5.27982289961859,
	2.36120333905757, 5.08809219497704, 4.14104761184517, 3.0507203126973, 2.68174990147577,
	5.53286644941928, 6.17423656227867, 2.07498516789302, 2.79760035622445, 4.49899202708674,
	2.88022020670444, 6.52818924572182, 4.40959633204772, 3.35493356674594, 2.24502496810542,
	5.49617651308843, 5.10052307626799, 2.39764051183249, 2.62577823176194, 4.43891823843701,
	11.0859049217670, 7.7690257159392, 7.84295205461749, 2.94280483053798, 2.30616358269353,
	4.73516430025054, 5.69620278771172, 2.19945853533234, 2.32955450432642, 3.70652819124601,
	8.94141649746176, 7.68081987027681, 7.03186654397297, 3.11848378518192, 2.45062944701293,
	4.76420890033152, 5.17770422178505, 2.01207034561444, 2.61352668338098, 3.54457681455316,
	8.08216172516506, 6.72691877799345, 5.97348980053014, 3.08319612956046, 2.15388489541020,
	4.98645949291703, 5.41135967790728, 2.11060945399763, 2.56734810011255, 3.91059184345957,
	7.92619718435554, 6.69758148613656, 5.68725701928831, 2.95265197001743, 2.08932875344871,
	4.89397447314105, 4.06457093684037, 2.11552228911978, 2.44499864058638, 3.63075541566978,
	7.03299969035814, 6.4036240247586, 5.39260235773519, 3.39092098732619, 2.03018065365897,
	4.05041347371477, 5.03419249489246, 2.13774549586728, 2.49645153482672, 3.00528199911706,
	7.12292998369262, 4.9913196602457, 6.35244430787905, 2.74750954029822, 2.58799933460768,
	4.39382097488525, 5.63200234334896, 1.91227850472791, 2.55921557230182, 3.01748110665328,
	6.02779791257298, 4.59542664761632, 10.0348563833458, 2.8277093721555, 3.55767216513833,
	3.70432679586678, 6.28097151127238, 2.63252277798006, 2.35381190121146, 3.37389798684639,
	6.00594142792848, 4.35674524308004, 11.2106555106168, 2.96388500313713, 2.92128404211512,
	3.60046567636709, 6.4942765586095, 3.88943038525207, 2.52221409223062, 2.99216163090793,
	5.32229592341627, 4.0838341234542, 9.72304198877294, 2.70270226713104, 3.05162938719822,
	3.21450054001851, 5.44256277922574, 3.1770423716578, 2.56952455740295, 2.94485595945987,
	5.14559611665251, 5.8223859078414, 8.82283181261235, 2.83315284627128, 3.06345021692982,
	3.74306359669718, 5.86657394667411, 2.77896919350908, 2.53637702949206, 2.65025096021421,
	4.78228082303286, 7.94675761756722, 7.50299805866292, 3.02151548412979, 3.14208328204400,
	3.5020012835528, 4.32853631666218, 2.92678965577055, 2.49771399488469, 2.75674768472912,
	3.93446541266719, 7.5802601754441, 6.97658744322604, 2.73971598891792, 2.87365050648208,
	3.14528692638114, 4.30131440103935, 2.77979237451472, 2.46012111237869, 3.45451063062676,
	3.69476287797707, 6.61238254416148, 7.15353565637268, 3.45307423269458, 2.45896328460726,
	3.54564039821969, 4.53752974995519, 2.64013450924038, 2.26015472252518, 5.9357524257689,
	3.9279356384104, 6.15614946100226, 6.13071924060842, 3.29549617773817, 2.62551269316564,
	3.12440478859942, 3.41958051887480, 2.2926526595146, 2.11173407492320, 5.03400790920116,
	2.95971208744503, 6.59087517365275, 5.88475801727308, 3.03252344302726, 2.31070289613336,
	3.57134667871111, 4.77412037536406, 2.36365092714797, 2.35850269580421, 4.78021192523347,
	3.19257368199377, 6.92989432273879, 5.47672360305869, 3.25975491652348, 2.38472462652585,
	2.90368210737774, 3.94429469234018, 2.54790737048559, 2.45066702740074, 4.97836605808068,
	3.16597652494402, 5.45161331595419, 4.32899820214533, 2.75536422249836, 2.51300041733908,
	3.62235377759478, 3.74872457668673, 2.08712041676458, 2.52572515953862, 4.66718881712077,
	3.37891819349831, 5.69839915321757, 4.53820898946749, 2.72270551104067, 2.41897173037081,
	3.57392092196046, 3.66024805206595, 2.23810827059702, 2.77948035771451, 5.05586378404877,
	5.53721395613081, 4.83955579544952, 4.54941278632232, 3.06022045942041, 2.38232594703012,
	3.65788799636526, 3.49335564294596, 2.13150189212589, 2.51821380220213, 5.44255656364568,
	6.33548370118606, 4.50610222890308, 3.75699634829958, 2.77575991881613, 2.27174880250459,
	4.68625122699912, 4.21177874645529, 2.08553923639606, 2.52486874027651, 4.42316348642002,
	5.06073891968984, 4.12776013997336, 4.34228669799229, 3.25764086630805, 1.91633140103361,
	3.8125229561453, 4.72086714116263, 1.92309183005361, 2.23982587309132, 4.38888845072467,
	4.2021638461726, 3.89358227826745, 4.84583137835946, 2.74981800207254, 2.13768965361845,
	4.01717779656311, 4.33204126510391, 2.2558007857004, 2.77584960523904, 4.43427877067707,
	4.31169100651717, 4.02438564794585, 7.32517798890912, 2.92729686093251, 2.19919787741463,
	3.59503803491476, 4.21232370956424, 1.82912912998865, 2.26239023855143, 3.74616081161833,
	4.49663374452007, 4.85116205441284, 13.5818388092691, 2.83044900151506, 2.0798352042709,
	4.40744510969806, 4.39919484949093, 2.06719488985609, 2.31118609014666, 3.78274531498309,
	5.20659159964532, 11.7454639247697, 14.5335925992373, 5.6747589547795, 2.12309082357874,
	3.0331106488522, 4.45642422024998, 2.32438790895229, 2.22720753264186, 3.60237039024115,
	9.2986629161477, 9.96907733689065, 15.4617146319798, 5.13627694513214, 2.20561654824686,
	4.79247478999385, 3.4905217381749, 6.09512260670142, 2.26016140090537, 3.98967190238820,
	10.8098632367534, 8.79055342068416, 11.8572301116684, 4.70202172702911, 2.07966160240547,
	5.20003901650911, 4.72485206879493, 6.40364408484155, 2.56587507947719, 2.92116161853119,
	10.7114133577771, 7.34708855907989, 12.9992609841286, 4.29956193541222, 3.07249188369186,
	5.00618532974062, 4.06259401439027, 5.55685504107436, 2.55314245029732, 2.95844453819681,
	8.46199368915424, 6.91597435075473, 12.3129499643917, 4.00783759767133, 6.96916266841067,
	3.85497746069374, 3.50218768427552, 4.64363064390277, 2.78351298018194, 2.66347040396868
    };

  pop_conc_vec.attr("dim") = Dimension(10, 144);

  // Convert concentration vector to matrix   
  NumericMatrix pop_conc_matrix = as<NumericMatrix>(pop_conc_vec);
  pop_conc_matrix = transpose(pop_conc_matrix);

  // Create Priors, Proposal Variances, Starting Values

  Rcpp::CharacterVector pop_location_prior = "order-statistic"; // or "order-statistic"
  Rcpp::List pop_priors = List::create(Named("mass_mean")               = 1,
                                       Named("mass_var")                = 100,
                                       Named("mass_p2p_sd_var")         = 2,
                                       Named("mass_s2s_sd_var")         = 2,
                                       Named("width_mean")              = 1.5,
                                       Named("width_var")               = 100,
                                       Named("width_p2p_sd_var")        = 2,
                                       Named("width_s2s_sd_var")        = 2,
                                       Named("baseline_mean")           = 3,
                                       Named("baseline_var")            = 100,
                                       Named("baseline_s2s_sd_var")     = 10,
                                       Named("halflife_mean")           = 45,
                                       Named("halflife_var")            = 100,
                                       Named("halflife_s2s_sd_var")     = 10,
                                       Named("error_alpha")             = .001,
                                       Named("error_beta")              = .001,
                                       Named("error_mean_pulse_count")  = 6);
  pop_priors.attr("class") = "bp_priors";

  // Create estimates object (w/ starting vals)
  Rcpp::List pop_startingvals = List::create(Named("mass_mean")       = 1,
                                         Named("mass_p2p_sd_var")     = 1,
                                         Named("mass_s2s_sd_var")     = 1,
                                         Named("width_mean")          = 1.5,
                                         Named("width_p2p_sd_var")    = 1,
                                         Named("width_s2s_sd_var")    = 1,
                                         Named("baseline_mean")       = 2.5,
                                         Named("baseline_s2s_sd_var") = 1,
                                         Named("halflife_mean")       = 45,
                                         Named("halflife_s2s_sd_var") = 1,
                                         Named("error_var")           = .25);
  pop_startingvals.attr("class") = "bp_startingvals";

  Rcpp::List pop_proposalvars = List::create(Named("sub_mass_mean") = 1,
                                         Named("pop_mass_mean")     = 0.5,
                                         Named("ind_mass")          = 2,
                                         Named("sub_width_mean")    = 1,
                                         Named("pop_width_mean")    = 0.5,
                                         Named("pv_ind_width")      = 5,
                                         Named("pop_baseline_mean") = 1,
                                         Named("sub_baseline")      = 0.015,
                                         Named("pop_halflife_mean") = 1,
                                         Named("sub_halflife")      = 50,
                                         Named("pulse_location")    = 1);
  pop_proposalvars.attr("class") = "bp_proposalvariance";

  //////////////// END LOADING DATA STRUCTURES ///////////////
  
  // test
  // Create sampler object
  Rcpp::List pop_rtn_list;
  pop_rtn_list = population_(pop_conc_matrix,
                         pop_time,
                         pop_location_prior,
                         pop_priors,
                         pop_proposalvars,
                         pop_startingvals,
                         100000,
                         50,
                         10000,
                         true,
                         500,
                         25000,
                         0.25,
                         0.35);
  

  return 0;


}


